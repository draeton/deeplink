var Deeplink=(function(window,$){var location=window.location;var monitorDelay=250;var monitorHash=function(){var oldURL;var newURL;var timeout;var monitor=function(){newURL=window.location.toString();if(newURL!==oldURL){$(window).trigger("hashchange");oldURL=newURL;}timeout=setTimeout(monitor,monitorDelay);};monitor();};if(!("onhashchange" in window)){monitorHash();}var methods={triggering:true,init:function(eq,sep){this.eq=eq||"=";this.sep=sep||"&";$(window).bind("hashchange",$.proxy(this.hashchange,this));$(window).trigger("hashchange");},parse:function(hash){var list,map,i,l,pair;list=hash.replace(/^\#/,"").split(this.sep);map={};for(i=0,l=list.length;i<l;i++){pair=list[i].split(this.eq);map[pair[0]]=pair[1];}return map;},stringify:function(map){var hash,i;hash="";for(i in map){if(map.hasOwnProperty(i)){if(typeof map[i]==="undefined"){hash+=this.sep+i;}else{hash+=this.sep+i+this.eq+map[i];}}}return hash.replace(new RegExp("^\\"+this.sep),"");},hashchange:function(){var hash,map;hash=location.hash;map=this.parse(hash);if(this.triggering){$(this).trigger("deeplink",{hash:hash,map:map});}this.triggering=true;},hashupdate:function(map,replace,fire){var hash,current;if(!replace){hash=location.hash;current=this.parse(hash);map=$.extend(current,map);}this.triggering=fire;location.hash=this.stringify(map);}};var Deeplink=function(eq,sep){this.init.apply(this,arguments);};Deeplink.prototype=methods;Deeplink.setDelay=function(ms){monitorDelay=ms;};return Deeplink;}(this,jQuery));